## 问题428 题解

### 题目分析

本题要求求解二项式 $(ax+by)^k$ 展开后，特定项 $x^n y^m$ 的系数，并对结果取模。这是一个典型的**二项式定理**应用题。

### 解题思路：二项式定理

根据二项式定理，$(X+Y)^k$ 的展开式的通项公式为：
$T_{i+1} = C(k, i) X^i Y^{k-i}$

将题目中的 $X=ax$ 和 $Y=by$ 代入，我们得到：
$T_{i+1} = C(k, i) (ax)^i (by)^{k-i} = C(k, i) a^i b^{k-i} x^i y^{k-i}$

题目要求的是 $x^n y^m$ 项的系数。通过对比指数，我们可以发现，当 $i=n$ 时，该通项就是我们需要的项（题目保证了 $n+m=k$，所以 $k-i = k-n = m$）。

因此，该项的系数为：
**系数 = $C(k, n) \times a^n \times b^m$**

我们需要分别计算这三个部分，并且在每一步乘法后都对 $10007$ 取模，以防止中间结果溢出。

#### 1. 计算组合数 $C(k, n) \pmod{10007}$

由于 `k` 的最大值只有1000，数据范围较小，我们可以预处理出所有可能用到的组合数。最简单的方法是使用**杨辉三角**的递推性质：
-   $C(i, j) = C(i-1, j-1) + C(i-1, j)$
-   边界条件: $C(i, 0) = 1$
我们可以创建一个二维数组 `C[1001][1001]`，在程序开始时就计算并存储好所有 $C(i,j) \pmod{10007}$ 的值。这样在需要时就可以 $O(1)$ 复杂度地直接查询。

#### 2. 计算幂 $a^n \pmod{10007}$ 和 $b^m \pmod{10007}$

由于指数 `n`, `m` 可能很大，直接乘方会导致超时。这里需要使用**快速幂**算法（也叫“平方求幂法”），它可以在 $O(\log n)$ 的时间内计算出 $a^n \pmod{p}$ 的值。

### 算法步骤总结

1.  **预处理**：程序开始时，通过动态规划（杨辉三角递推）计算出所有 $C(i, j)$ 对 $10007$ 取模的值，存入 `C[1001][1001]` 表中。
2.  **输入**：读取 `a, b, k, n, m`。
3.  **计算 $a^n$**：调用快速幂函数，计算 `power(a, n) % 10007`。
4.  **计算 $b^m$**：调用快速幂函数，计算 `power(b, m) % 10007`。
5.  **查找组合数**：直接从预处理的表中获取 `C[k][n]` 的值。
6.  **合并结果**：将三部分的结果相乘，每一步乘法后都取模，得到最终答案：
    `result = (power(a,n) * power(b,m)) % MOD;`
    `result = (result * C[k][n]) % MOD;`
7.  **输出**：输出最终的`result`。
