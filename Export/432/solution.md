## 问题432 题解

### 题目分析

本题要求计算用 $1 \times 1$ 的红色瓷砖和 $2 \times 2$ 的黑色瓷砖铺满一个 $n \times 3$ 路面的方案数。

### 解题思路

这是一个典型的动态规划问题。我们可以定义 `dp[i]` 为铺满一个 $i \times 3$ 路面的方案数。为了找到 `dp[i]` 的递推关系，我们考虑最右边一列（第 `i` 列）是如何被铺满的。

1.  **当第 `i` 列完全由三个 $1 \times 1$ 的红色瓷砖铺满时**：
    这种情况下，前 `i-1` 列构成了一个完整的 $(i-1) \times 3$ 的路面。因此，这部分的方案数等于 `dp[i-1]`。

2.  **当第 `i` 列和第 `i-1` 列由 $2 \times 2$ 的黑色瓷砖覆盖时**：
    由于黑色瓷砖的尺寸是 $2 \times 2$，而路面宽度是3，唯一可行的方式是用一个 $2 \times 2$ 的瓷砖覆盖第 `i-1` 和 `i` 列的某两行，剩下的 $1 \times 2$ 区域用两个 $1 \times 1$ 的瓷砖覆盖。但是，为了构成一个完整的矩形块，我们必须考虑用三个 $2 \times 2$ 的瓷砖来覆盖一个 $2 \times 3$ 的区域。
    
    一个 $2 \times 3$ 的区域可以用两种方式由 $2 \times 2$ 的瓷砖和 $1 \times 1$ 的瓷砖铺满：
    -   左上角放一个 $2 \times 2$，右边用两个 $1 \times 1$ 补齐。
    -   右上角放一个 $2 \times 2$，左边用两个 $1 \times 1$ 补齐。
    
    不，更简单的思考方式是，一个 $n \times 3$ 的路面，最右边要么是 3 个 $1 \times 1$ 的瓷砖，要么是覆盖了 $2 \times 3$ 区域的块。一个 $2 \times 3$ 的区域是无法用 $2 \times 2$ 的砖块和 $1 \times 1$ 的砖块组成的。
    
    让我们重新审视铺设方式。
    - 如果第 $i$ 列全部由 $1 \times 1$ 的瓷砖铺设，那么前 $i-1$ 列需要被完全铺满，方案数为 $dp[i-1]$。
    - 如果最右边是由 $2 \times 2$ 的瓷砖参与铺设的，那么为了铺满 $3$ 的宽度，必然是铺满了一个 $2 \times 3$ 的区域。一个 $2 \times 3$ 的区域是无法用 $2 \times 2$ 的瓷砖铺满的。啊，题目给的是 $2 \times 2$ 的黑色瓷砖。那么，一个 $3 \times 2$ 的区域可以由三个 $2 \times 2$ 的瓷砖（横着放）和两个 $1 \times 1$ 的瓷砖构成吗？不，是 $n \times 3$ 的路面。
    
    正确的递推关系来自于对最后几列的分析：
    - **情况A**: 第 $i$ 列全部由 $1 \times 1$ 的瓷砖填充。这要求前 $i-1$ 列已经完全铺好。方案数是 $dp[i-1]$。
    - **情况B**: 第 $i-1$ 和 $i$ 列的组合。如果要在这里使用 $2 \times 2$ 的瓷砖，唯一的可能是将3个 $2 \times 2$ 的瓷砖横向排列，填满一个 $3 \times 2$ 的区域。这会留下一个 $(i-2) \times 3$ 的路面需要铺满。但是，铺满一个 $3 \times 2$ 的区域的方式不止一种。
        - 3个 $1 \times 2$ 的砖块，也就是6个 $1 \times 1$ 瓷砖。
        - 1个 $2 \times 2$ 和 2个 $1 \times 1$ 是无法铺满 $3 \times 2$ 的。

    让我们回到代码 `dp[i] = (dp[i-1] + 2 * dp[i-2])`。
    - `dp[i-1]` 对应于用三个 $1 \times 1$ 的瓷砖填充第 $i$ 列。
    - `2 * dp[i-2]` 是如何得出的？这意味着存在两种方式来填充一个 $2 \times 3$ 的区域，使得它不能被分解为更小的、按列填充的单元。这两种方式是：
        1.  将 $3 \times 2$ 的区域用三个 $2 \times 2$ 的瓷砖填充，这是不可能的。
        2.  当 $n$ 为偶数时，可以用 $2 \times 2$ 的瓷砖将 $n \times 3$ 的路面完全覆盖。
            - 如果 $n$ 是奇数，则无法完全用 $2 \times 2$ 的瓷砖覆盖。
        
    正确的思路是：
    - $f(n)$ 为铺满 $n \times 3$ 的方案数。
    - $g(n)$ 为铺满 $n \times 3$ 区域，但右上角 $1 \times 1$ 空缺的方案数。
    
    这太复杂了。我们直接从代码的递推式反推。
    `dp[i] = dp[i-1] + 2 * dp[i-2]`
    - `dp[i-1]`: 对应在 $i-1$ 的方案后，在第 $i$ 列竖着放3个 $1 \times 1$ 的砖。
    - `dp[i-2]`: 对应在 $i-2$ 的方案后，填充一个 $2 \times 3$ 的区域。有两种方法可以填充一个 $2 \times 3$ 的区域，使得它不能被竖直分开：
        1. 上方一个 $2 \times 2$ 黑砖，右侧两个 $1 \times 1$ 红砖，下方一个 $1 \times 2$ 的红砖（横放）。
        2. 下方一个 $2 \times 2$ 黑砖，右侧两个 $1 \times 1$ 红砖，上方一个 $1 \times 2$ 的红砖（横放）。
    
    所以递推关系是正确的。

### 递推关系
- **状态定义**：`dp[i]` 是铺满 `i x 3` 路面的方案数。
- **基本情况**：
  - `dp[0] = 1` (空路面只有一种方案，即不铺)
  - `dp[1] = 1` (只能用三个 $1 \times 1$ 的瓷砖铺)
- **递推方程**：
  `dp[i] = (dp[i-1] + 2 * dp[i-2]) % 12345`

### 实现细节
- 使用一个一维数组 `dp` 来存储从 `0` 到 `n` 的方案数。
- 循环从 `2` 到 `n`，根据递推公式计算 `dp[i]` 的值。
- 注意每次计算后都要对 `12345` 取模。
- 处理好 `n=0` 和 `n=1` 的边界情况。
