## 问题494 题解

### 题目分析

这个问题要求我们在一个 $N \times M$ 的矩阵中，找到一个大小为 $C \times C$ 的正方形子矩阵，使其内部所有元素的和最大。这是一个固定大小的子矩阵求和问题。

### 解题思路

这个问题是二维前缀和的一个典型应用。暴力解法是遍历所有可能的 $C \times C$ 子矩阵，然后计算每个子矩阵的和，时间复杂度为 $O(N \cdot M \cdot C^2)$，对于本题的数据范围来说会超时。

我们可以使用二维前缀和来优化计算子矩阵和的过程。

1.  **预处理：构造二维前缀和数组**
    -   我们创建一个二维数组 `prefix_sum`，其中 `prefix_sum[i][j]` 存储了从左上角 `(1, 1)` 到 `(i, j)` 的矩形区域内所有元素的和。
    -   递推关系为：
        `prefix_sum[i][j] = value[i][j] + prefix_sum[i-1][j] + prefix_sum[i][j-1] - prefix_sum[i-1][j-1]`
    -   这个预处理过程的时间复杂度是 $O(N \times M)$。

2.  **遍历并计算**
    -   我们遍历所有可能的 $C \times C$ 子矩阵的左上角 `(i, j)`。
        -   `i` 的范围是 `1` 到 `N-C+1`。
        -   `j` 的范围是 `1` 到 `M-C+1`。
    -   对于每一个左上角 `(i, j)`，其对应的右下角是 `(i+C-1, j+C-1)`。
    -   利用预处理好的前缀和数组，我们可以在 $O(1)$ 的时间内计算出这个 $C \times C$ 子矩阵的和：
        `Sum = prefix_sum[i+C-1][j+C-1] - prefix_sum[i-1][j+C-1] - prefix_sum[i+C-1][j-1] + prefix_sum[i-1][j-1]`
    -   在遍历过程中，我们维护一个全局的最大和 `max_sum` 以及取得最大和时的左上角坐标。

通过这种方法，总的时间复杂度被优化到 $O(N \times M)$。
