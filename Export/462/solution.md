## 问题462 题解

### 题目分析

本题是经典汉诺塔问题的一个变种，通常被称为**双塔汉诺塔问题**。与标准汉诺塔不同的是，这里有 $n$ 种尺寸的圆盘，每种尺寸有2个，共 $2n$ 个。目标是将它们从A柱全部移动到C柱，规则不变。

### 推导递推关系

设 $A_n$ 为移动 $n$ 对（$2n$ 个）圆盘所需的最少步数。我们可以通过递归来思考这个问题：

1.  **目标**: 将 A 柱上的 $n$ 对盘子移动到 C 柱。
2.  **第一步**: 为了能移动 A 柱最底部的两个最大的盘子（$n$ 号盘），我们必须先将它们上面的 $n-1$ 对盘子（共 $2n-2$ 个）全部从 A 柱移开。根据汉诺塔的规则，最优策略是将这 $n-1$ 对盘子借助 C 柱，全部移动到 B 柱上。这个过程所需的操作次数，正好是解决一个规模为 $n-1$ 的双塔汉诺塔问题的步数，即 $A_{n-1}$。
3.  **第二步**: 现在，A 柱上只剩下两个最大的 $n$ 号盘，B 柱上有 $n-1$ 对盘子，C 柱是空的。我们需要将这两个 $n$ 号盘从 A 移动到 C。因为它们是最大的，我们可以忽略 B 柱上的其他盘子。移动步骤如下：
    -   将 A 柱上的一个 $n$ 号盘移动到 C 柱。 (1步)
    -   将 A 柱上剩下的另一个 $n$ 号盘移动到 C 柱。 (1步)
    -   （这里可以这样做，因为两个n号盘大小相同，规则是“上小下大”，所以一个n号盘可以放在另一个n号盘上）。
    -   因此，移动这两个最大的盘子需要 **2** 步。
4.  **第三步**: 最后，我们将 B 柱上的 $n-1$ 对盘子，借助 A 柱，全部移动到 C 柱上，放到两个 $n$ 号盘的上面。这个过程同样需要 $A_{n-1}$ 步。

综上所述，我们得到了总步数的递推关系：
$A_n = A_{n-1} + 2 + A_{n-1} = 2 \cdot A_{n-1} + 2$

### 求解通项公式

我们有了递推式 $A_n = 2 \cdot A_{n-1} + 2$。我们需要一个初始条件。
-   当 $n=1$ 时，A柱上有2个1号盘。移动步骤为：A→B, A→C, B→C。这是错的。
-   正确的移法是 A->B, A->C。此时两个盘子都在目标柱C了？不，只有一个。
-   从样例我们可以得到：$A_1 = 2$，$A_2 = 6$。
-   验证我们的递推式：$A_2 = 2 \cdot A_1 + 2 = 2 \cdot 2 + 2 = 6$。递推式是正确的。

现在我们来解这个递推式：
$A_n + 2 = 2 \cdot A_{n-1} + 4 = 2(A_{n-1} + 2)$
这是一个公比为2的等比数列。
$A_n + 2 = (A_1 + 2) \cdot 2^{n-1} = (2+2) \cdot 2^{n-1} = 4 \cdot 2^{n-1} = 2^2 \cdot 2^{n-1} = 2^{n+1}$

所以，通项公式为：$A_n = 2^{n+1} - 2$

### 算法实现
由于 $n$ 最大可达 1000，所以 $2^{1001}$ 是一个非常巨大的数字，必须使用**高精度算法**。
1.  计算 $2^{n+1}$，这需要实现**高精度乘法**（大数乘以2）。
2.  从上一步得到的大数结果中减去2，这需要实现**高精度减法**（大数减小数）。

最终的程序将主要由这两个高精度运算函数和一个主循环构成。
