## 问题526 题解

### 题目分析

本题要求我们找出一个给定的正整数 $M$ 所有可能的“连续正整数和”的分解方案。即，寻找所有的正整数对 $(l, r)$ 使得 $l + (l+1) + \dots + r = M$。

### 数学推导

这是一个经典的数论问题。我们可以从等差数列的求和公式入手。
设连续序列的首项为 $l$，长度为 $n$（$n = r - l + 1$）。
那么，这 $n$ 个数的和 $M$ 为：
$ M = \frac{n \cdot (l + (l+n-1))}{2} = \frac{n \cdot (2l + n - 1)}{2} $

我们将这个公式变形，以求解 $l$：
$ 2M = n \cdot (2l + n - 1) $
$ \frac{2M}{n} = 2l + n - 1 $
$ 2l = \frac{2M}{n} - n + 1 $
$ l = \frac{M}{n} - \frac{n-1}{2} $

从这个公式我们可以得出结论：对于一个给定的序列长度 $n$，我们可以计算出对应的首项 $l$。如果这个计算出的 $l$ 是一个正整数，那么我们就找到了一个有效的分解方案。

### 算法思路

我们可以遍历所有可能的序列长度 $n$，然后使用上述公式来反解出 $l$，并检查其是否合法。

#### 1. 确定 $n$ 的遍历范围
-   **下限**: 题目要求 $l < r$，这意味着序列至少包含两个数，所以 $n \ge 2$。
-   **上限**: 序列的和 $M$ 必须大于等于 $1+2+\dots+n$（即首项 $l$ 最小为1时的情况）。
    $ M \ge \frac{n(n+1)}{2} $
    $ 2M \ge n^2 + n $
    这个不等式告诉我们，$n^2$ 大致上小于 $2M$，所以 $n$ 的上限大约为 $\sqrt{2M}$。
    对于 $M \le 10^8$，$\sqrt{2M} \approx 14142$。这个遍历范围对于现代计算机来说是完全可以接受的。

#### 2. 遍历与求解

我们的算法流程如下：

1.  **循环**: 从 $n=2$ 开始，向上遍历到 $n \approx \sqrt{2M}$。
2.  **求解 $l$**: 在循环的每一步中，我们使用公式 $l = \frac{M}{n} - \frac{n-1}{2}$ 来计算 $l$。
3.  **合法性检查**: 为了确保 $l$ 是一个正整数，我们需要进行两步检查：
    -   **整除检查**: $\frac{2M}{n} - n + 1$ 必须是一个偶数，这样它除以2才能得到整数 $l$。这等价于 $(2M - n^2 + n)$ 必须能被 $2n$ 整除。
    -   **正数检查**: 计算出的 $l$ 必须大于 0。

4.  **存储与输出**:
    -   如果一个 $n$ 计算出的 $l$ 通过了上述所有检查，我们就找到了一个有效的数对 $(l, r)$，其中 $r = l + n - 1$。
    -   将所有找到的数对 $(l, r)$ 存储起来。
    -   题目要求按 $l$ 升序输出。当我们按 $n$ 从小到大遍历时，计算出的 $l$ 是从大到小出现的。因此，我们需要在所有计算结束后，对结果进行一次**排序**，然后再输出。

这个算法通过一个简单的循环和数学公式，将问题高效地解决。其时间复杂度主要由循环次数决定，约为 $O(\sqrt{M})$。
