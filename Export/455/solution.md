## 问题455 题解

### 题目分析

本题要求我们计算一个特定规则的累加和 $S$。这个和的定义涉及到了阶乘的累加。设第 $i$ 天的费用为 $C_i$，那么：
-   $C_i = 1! + 2! + \dots + i!$
-   $S = C_1 + C_2 + \dots + C_n$

我们可以将 $S$ 的表达式展开，分析每个阶乘 $k!$ 在最终总和中出现的次数。
-   $1!$ 出现在 $C_1, C_2, \ldots, C_n$ 中，共出现 $n$ 次。
-   $2!$ 出现在 $C_2, C_3, \ldots, C_n$ 中，共出现 $n-1$ 次。
-   ...
-   $k!$ 出现在 $C_k, C_{k+1}, \ldots, C_n$ 中，共出现 $n-k+1$ 次。

因此，总和 $S$ 可以表示为：
$S = \sum_{i=1}^{n} (n-i+1) \cdot i!$

由于阶乘增长非常迅速（例如，$20!$ 已经非常大），计算结果 $S$ 必定会超出标准64位整数的范围。因此，我们必须使用**高精度算法**来处理整个计算过程。

### 解题思路

我们将采用迭代的方式，根据上述推导出的公式来计算 $S$。在整个过程中，我们需要使用高精度数来存储中间结果（阶乘）和最终结果（总和）。

#### 需要的高精度运算
1.  **高精度加法**: 用于将每一项的计算结果累加到总和 $S$ 上。
2.  **高精度乘低精度**: 用于计算每一项 `term = (高精度阶乘) * (普通整数)`，以及更新阶乘 `new_factorial = (旧高精度阶乘) * (普通整数)`。

#### 算法步骤

1.  **初始化**:
    -   初始化一个高精度数 `S` 为 `"0"`，用于存放最终的总和。
    -   初始化一个高精度数 `current_factorial` 为 `"1"`，它将在循环中依次代表 $1!, 2!, 3!, \ldots$。

2.  **主循环**:
    -   我们建立一个从 $i=1$ 到 $n$ 的循环。在每一次循环中，我们计算公式中的一项 `(n-i+1) * i!` 并累加到 `S` 中。
    -   在第 `i` 次循环开始时，`current_factorial` 存储的是 `(i-1)!` 的值（在 `i=1` 时，我们视其为 `1`）。

3.  **循环体内部**:
    -   **更新阶乘**: 首先，将 `current_factorial` 更新为 $i!$。这是一个高精度乘低精度的操作：`current_factorial = current_factorial * i`。
    -   **计算当前项**: 计算 `term = current_factorial * (n - i + 1)`。这同样是一个高精度乘低精度的操作。
    -   **累加到总和**: 将 `term` 加到 `S` 上。这是一个高精度加法操作：`S = S + term`。

4.  **循环结束后**:
    -   当循环从 $i=1$ 到 $n$ 全部完成后，高精度数 `S` 中存储的就是最终的答案。

**优化**:
在上面的描述中，我们在循环内先更新阶乘再计算项。实际上，为了更贴合公式 $\sum (n-i+1) \cdot i!$，我们可以在循环开始时，`current_factorial` 代表 $i!$，然后在循环末尾更新它为 $(i+1)!$，逻辑上更清晰。

**示例 (n=3)**
1. `S="0"`, `factorial="1"` (1!)
2. `i=1`:
   - `term = factorial * (3-1+1) = "1" * 3 = "3"`
   - `S = "0" + "3" = "3"`
3. `i=2`:
   - `factorial = factorial * 2 = "1" * 2 = "2"` (2!)
   - `term = factorial * (3-2+1) = "2" * 2 = "4"`
   - `S = "3" + "4" = "7"`
4. `i=3`:
   - `factorial = factorial * 3 = "2" * 3 = "6"` (3!)
   - `term = factorial * (3-3+1) = "6" * 1 = "6"`
   - `S = "7" + "6" = "13"`
5. 结束，输出 `S`="13"。

这个方法通过迭代，逐步计算并累加每一项，全程使用高精度运算来保证结果的正确性。
