## 问题421 题解

### 题目分析

本题要求我们构造一个特殊的递增序列，并找出该序列的第`n`项。序列的构成规则是“所有k的方幂”以及“有限个互不相等的k的方幂之和”。

这是一个隐藏了进制思想的数学问题。让我们来解码这个序列的真正含义：

-   `k`的方幂：k⁰, k¹, k², ...
-   互不相等的`k`的方幂之和：例如 `k⁰ + k²`, `k¹ + k⁵ + k⁶` 等。

如果我们将这些数用`k`进制来表示，会发现一个规律。例如，`k¹ + k⁵ + k⁶` 对应的`k`进制数就是 `1100010`。
因为所有参与求和的`k`的方幂都是**互不相等**的，这意味着在`k`进制表示中，每一位的系数只可能是`0`或`1`，不可能出现`2`或更高的系数。

所以，这个序列实际上是所有**`k`进制下只由0和1组成的数**，按从小到大排列而成的。

### 解题思路：二进制与k进制的映射

当我们把这些`k`进制下只由0和1组成的数（`...d_i...` 其中 `d_i ∈ {0, 1}`）列出来时，会发现一个奇妙的对应关系：

| 序列项 | k进制表示 | 如果看作二进制 | 十进制值 |
|:---:|:---:|:---:|:---:|
| 1 | (1)_k | (1)_2 | 1 |
| 2 | (10)_k | (10)_2 | 2 |
| 3 | (11)_k | (11)_2 | 3 |
| 4 | (100)_k| (100)_2 | 4 |
| ... | ... | ... | ... |
| `n` | ? | `(n)_10`的二进制 | `n` |

这个表格揭示了核心规律：**我们要求的序列第`n`项，其`k`进制的表示形式，恰好就是`n`这个数字本身的二进制表示形式**。

例如，求`k=3, n=4`时的序列第4项：
1.  `n=4`的二进制是`100`。
2.  我们将`100`看作是一个**3进制**的数，即 `(100)_3`。
3.  计算这个3进制数的值：`1 * 3² + 0 * 3¹ + 0 * 3⁰ = 9`。
4.  所以，序列第4项就是9。

#### 实现算法

这个思想可以转化为一个具体的算法，即“**将`n`按二进制分解，以`k`为基底求权值和**”。

1.  初始化结果`result = 0`。
2.  初始化`k`的方幂`power_of_k = 1`（代表k⁰）。
3.  对`n`进行循环，只要`n > 0`：
    -   检查`n`的二进制最低位是否为1（`if (n % 2 == 1)`）。
    -   如果为1，说明`n`的二进制当前位是1，那么我们需要将对应的`k`的权重（`power_of_k`）累加到`result`中。
    -   `n`除以2（或右移一位 `n >>= 1`），以处理`n`的下一位。
    -   `power_of_k`乘以`k`，以更新权重。
4.  循环结束后，`result`就是最终答案。
